attribute vec3 vertex;
attribute vec4 uv;
attribute vec3 normal;
attribute vec3 normal2;
attribute vec4 color;
attribute vec4 color2;
attribute UNITY_VERTEX_INPUT_INSTANCE_ID UNITY_VERTEX_INPUT_INSTANCE_ID;

uniform ShaderFeature _SMOOTH_FADE;
uniform float _Wind;
uniform float _DistMin;
uniform float _DistMax;

varying vec4 color;
varying vec3 normal;
varying vec3 worldPos;
varying UNITY_VERTEX_INPUT_INSTANCE_ID UNITY_VERTEX_INPUT_INSTANCE_ID;
varying UNITY_VERTEX_OUTPUT_STEREO UNITY_VERTEX_OUTPUT_STEREO;
varying UNITY_FOG_COORDS UNITY_FOG_COORDS;

main(){
	UNITY_SETUP_INSTANCE_ID(UNITY_VERTEX_INPUT_INSTANCE_ID);
	UNITY_TRANSFER_INSTANCE_ID(UNITY_VERTEX_INPUT_INSTANCE_ID, UNITY_VERTEX_INPUT_INSTANCE_ID);
	UNITY_INITIALIZE_VERTEX_OUTPUT_STEREO(UNITY_VERTEX_OUTPUT_STEREO);
	vec3 l1_worldPos = mul(unity_ObjectToWorld, float4(vertex.xyz, 1.0));
	vec3 l2_normal = UnityObjectToWorldNormal(normal);
	float t = 0.0;
	if (_SMOOTH_FADE) {
		t = (distance(mul(unity_ObjectToWorld, float4(0.0, 0.0, 0.0, 1.0)), _WorldSpaceCameraPos.xyz) - _DistMin) / (_DistMax - _DistMin);
		t = saturate(t);
		l1_worldPos = lerp(l1_worldPos, mul(unity_ObjectToWorld, float4(uv.xyz, 1.0)), t);
		l2_normal = lerp(l2_normal, UnityObjectToWorldNormal(normal2), t);
	}
	normal = l2_normal;
	float intensOr = 1.0 - color.a;
	float intens = intensOr;
	float val = lerp(0.0, 0.5, _Wind);
	float _Wavelength = 3.3;
	float _Speed = 15.0;
	float _Amplitude = 0.2;
	intens = intens * val;
	_Speed = _Speed * val;
	float windForce = 0.5 + sin(0.8 * _Time.y);
	vec4 wave = float4(0.3, -0.2, 0.3, 0.0) * windForce;
	float tShift = saturate(windForce - 0.8) * 0.0;
	vec3 p = l1_worldPos;
	float k = (2 * UNITY_PI) / _Wavelength;
	float f = k * (p.x - (_Speed * (_Time.y + (uv.w * tShift))));
	sincos(f, sr, cr);
	p.x = p.x + ((_Amplitude * cr) * intens);
	p.y = p.y + ((_Amplitude * sr) * intens);
	p = p + ((((wave.xyz * intensOr) * 1.3) / 0.4) * val);
	l1_worldPos = p;
	worldPos = l1_worldPos;
	gl_Position = mul(UNITY_MATRIX_VP, float4(l1_worldPos.xyz, 1.0));
	if (!_SMOOTH_FADE ) {
		color = color;
	} else {
		color = lerp(color, color2, t);
	}
	UNITY_TRANSFER_FOG(UNITY_FOG_COORDS, gl_Position);
	return;//gl_Position is set

}
/*___unresolved_____

_____________*/
